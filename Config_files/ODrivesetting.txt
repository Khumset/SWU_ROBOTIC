dev0.config.dc_max_negative_current = -3

dev0.axis0.motor.config.pole_pairs = 4
dev0.axis0.motor.config.calibration_current = 15
dev0.axis0.motor.config.resistance_calib_max_voltage= 12
dev0.axis0.motor.config.motor_type =MOTOR_TYPE_HIGH_CURRENT
dev0.axis0.motor.config.torque_constant = 0.11 * 12
dev0.axis0.motor.config.current_lim = 37
dev0.axis0.motor.config.requested_current_range = 60

dev0.axis0.encoder.config.mode=ENCODER_MODE_INCREMENTAL
dev0.axis0.encoder.config.cpr= 2500 * 4
dev0.axis0.encoder.config.bandwidth = 2000
dev0.axis0.motor.config.current_control_bandwidth = 2000

dev0.axis0.controller.config.control_mode = CONTROL_MODE_VELOCITY_CONTROL
dev0.axis0.controller.config.vel_limit = 50
dev0.axis0.controller.config.input_mode = INPUT_MODE_VEL_RAMP
dev0.axis0.controller.config.vel_ramp_rate = 2

dev0.axis0.requested_state = AXIS_STATE_MOTOR_CALIBRATION
dev0.axis0.requested_state = AXIS_STATE_FULL_CALIBRATION_SEQUENCE  
dev0.axis0.encoder.config.use_index = True
dev0.axis0.requested_state = AXIS_STATE_ENCODER_INDEX_SEARCH
dev0.axis0.requested_state = AXIS_STATE_ENCODER_OFFSET_CALIBRATION
dev0.axis0.encoder.shadow_count
dev0.axis0.encoder.config.pre_calibrated = True
dev0.axis0.config.startup_encoder_index_search  = True
dev0.axis0.motor.config.pre_calibrated = True
dev0.save_configuration()

dev0.axis0.requested_state = AXIS_STATE_CLOSED_LOOP_CONTROL
dev0.axis0.controller.input_vel = 0
dev0.axis0.controller.input_vel = 5
dev0.axis0.requested_state = AXIS_STATE_IDLE

dev0.axis0.controller.config.pos_gain = 0
dev0.axis0.controller.config.vel_gain = 12
dev0.axis0.controller.config.vel_integrator_gain = 22.5


dev0.axis1.motor.config.pole_pairs = 4
dev0.axis1.motor.config.calibration_current = 15
dev0.axis1.motor.config.resistance_calib_max_voltage= 12
dev0.axis1.motor.config.motor_type =MOTOR_TYPE_HIGH_CURRENT
dev0.axis1.motor.config.torque_constant = 0.11 * 12
dev0.axis1.motor.config.current_lim = 37
dev0.axis1.motor.config.requested_current_range = 60

dev0.axis1.encoder.config.mode=ENCODER_MODE_INCREMENTAL
dev0.axis1.encoder.config.cpr= 2500 * 4
dev0.axis1.encoder.config.bandwidth = 2000
dev0.axis1.motor.config.current_control_bandwidth = 2000

dev0.axis1.controller.config.control_mode = CONTROL_MODE_VELOCITY_CONTROL
dev0.axis1.controller.config.vel_limit = 50
dev0.axis1.controller.config.input_mode = INPUT_MODE_VEL_RAMP
dev0.axis1.controller.config.vel_ramp_rate = 2

dev0.axis1.requested_state = AXIS_STATE_MOTOR_CALIBRATION
dev0.axis1.requested_state = AXIS_STATE_FULL_CALIBRATION_SEQUENCE  
dev0.axis1.encoder.config.use_index = True
dev0.axis1.requested_state = AXIS_STATE_ENCODER_INDEX_SEARCH
dev0.axis1.requested_state = AXIS_STATE_ENCODER_OFFSET_CALIBRATION
dev0.axis1.encoder.shadow_count
dev0.axis1.encoder.config.pre_calibrated = True
dev0.axis1.config.startup_encoder_index_search  = True
dev0.axis1.motor.config.pre_calibrated = True
dev0.save_configuration()

dev0.axis1.requested_state = AXIS_STATE_CLOSED_LOOP_CONTROL
dev0.axis1.controller.input_vel = 0
dev0.axis1.controller.input_vel = 5
dev0.axis1.requested_state = AXIS_STATE_IDLE

dev0.axis1.controller.config.pos_gain = 0
dev0.axis1.controller.config.vel_gain = 12
dev0.axis1.controller.config.vel_integrator_gain = 22.5

start_liveplotter(lambda:[dev0.axis0.encoder.vel_estimate, dev0.axis0.controller.input_vel])
start_liveplotter(lambda:[dev0.axis1.encoder.vel_estimate, dev0.axis1.controller.input_vel])

dev0.axis0.requested_state = AXIS_STATE_CLOSED_LOOP_CONTROL
dev0.axis1.requested_state = AXIS_STATE_CLOSED_LOOP_CONTROL
dev0.axis0.controller.input_vel = 0
dev0.axis1.controller.input_vel = 0
dev0.axis0.controller.input_vel = 5
dev0.axis1.controller.input_vel = 5
dev0.axis0.requested_state = AXIS_STATE_IDLE
dev0.axis1.requested_state = AXIS_STATE_IDLE